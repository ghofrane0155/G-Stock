<div class="container">
    <div class="page-inner">
      <div class="page-header mb-4">
        <h3 class="fw-bold">Product Management</h3>
        <ul class="breadcrumbs">
          <li class="nav-home">
            <a routerLink="/dashboard">
              <i class="icon-home"></i>
            </a>
          </li>
          <li class="separator">
            <i class="icon-arrow-right"></i>
          </li>
          <li class="nav-item">
            <a routerLink="/products">Products</a>
          </li>
        </ul>
      </div>
  
      <div class="row">
        <div class="col-md-12">
          <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
              <h4 class="card-title mb-0">{{ editingProduit ? 'Edit Product' : 'Add New Product' }}</h4>
            </div>
            <div class="card-body">
              <form [formGroup]="produitForm" (ngSubmit)="editingProduit ? updateProduit() : addProduit()">
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="productName">Product Name</label>
                    <input
                      type="text"
                      id="productName"
                      class="form-control"
                      formControlName="nomProduit"
                    />
                  </div>
                  <div class="form-group col-md-6">
                    <label for="productPrice">Price</label>
                    <input
                      type="number"
                      id="productPrice"
                      class="form-control"
                      formControlName="prixUnitaire"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-12">
                    <label for="productDescription">Description</label>
                    <textarea
                      id="productDescription"
                      class="form-control"
                      formControlName="description"
                      rows="3"
                    ></textarea>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="productCode">Code</label>
                    <input
                      type="text"
                      id="productCode"
                      class="form-control"
                      formControlName="codeBarre"
                    />
                  </div>
                  <div class="form-group col-md-6">
                    <label for="productLogo">Logo</label>
                    <input
                      type="file"
                      id="productLogo"
                      class="form-control"
                      (change)="onFileChange($event)"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-12">
                    <label for="productCategory">Category</label>
                    <select
                      id="productCategory"
                      class="form-control"
                      formControlName="categorieId"
                    >
                      <option *ngFor="let category of categories" [value]="category.idCategorie">
                        {{ category.nomCategorie }}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="form-row">
                  <div class="col-md-12 d-flex justify-content-end">
                    <button type="submit" class="btn btn-primary mr-2">{{ editingProduit ? 'Update Product' : 'Add Product' }}</button>
                    <button type="button" class="btn btn-secondary" (click)="clearSelection()">Cancel</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
  
      <div class="row mt-4">
        <div class="col-md-12">
          <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
              <h4 class="card-title mb-0">Product List</h4>
              <input
                type="text"
                class="form-control mt-3"
                placeholder="Search by product name"
                [(ngModel)]="searchTerm"
                (ngModelChange)="updatePaginatedProduits()"
              />
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <thead>
                    <tr>
                      <th>Product Name</th>
                      <th>Description</th>
                      <th>Price</th>
                      <th>Category</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let produit of paginatedProduits">
                      <td>{{ produit.nomProduit }}</td>
                      <td>{{ produit.description }}</td>
                      <td>{{ produit.prixUnitaire | currency }}</td>
                      <td>{{ (produit.categorie?.nomCategorie) || 'N/A' }}</td>
                      <td>
                        <button class="btn btn-primary btn-sm" (click)="editProduit(produit)">Edit</button>
                        <button class="btn btn-danger btn-sm ml-2" (click)="deleteProduit(produit.idProduit)">Delete</button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <nav class="mt-3">
                <ul class="pagination justify-content-center">
                  <li class="page-item" [class.disabled]="currentPage === 1">
                    <a class="page-link" (click)="changePage(currentPage - 1)">Previous</a>
                  </li>
                  <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index">
                    <a class="page-link" [class.active]="isActivePage(i + 1)" (click)="changePage(i + 1)">{{ i + 1 }}</a>
                  </li>
                  <li class="page-item" [class.disabled]="currentPage === totalPages">
                    <a class="page-link" (click)="changePage(currentPage + 1)">Next</a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  